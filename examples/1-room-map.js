// This example generates a playable .bin file of a simple 1 room map.
// It contains a player spawn, dirt border, and a single spinner.

const { Entity, Room, Side, Tiles } = require('../lucid');

// change this to where ever you wanna generate the new .bin file
const destFile = 'output/test.bin';
const tileString = `
1111111111111111111111111111111111111111
1111111111000000000000000001111111111111
1111100000000000000000000000011111111111
1000000000000000000000000000000111111111
1000000000000000000000000000000001111111
1000000000000000000000000000000000011111
1000000000000000000000000000000000000111
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000000000000000000000000001
1000000000000000011111110000000000000001
1000000000000000011111110000000000000001
1000000000001111111111111111100000000001
1111111111111111111111111111111111111111
`;

(async function() {
	try {
		const side = new Side();
		const player = new Entity('player', {
			x: 20,
			y: 176
		});
		const spinner = new Entity('spinner', {
			x: 152,
			color: 'Blue',
			attachToSolid: false,
			y: 120
		});
		const room = new Room({
			name: 'intro',
			position: [ 0, 0 ],
			size: [ 320, 184 ],
			fgTiles: new Tiles(tileString),
			entities: [ player, spinner ]
		});

		side.map.rooms.push(room);

		await side.encode(destFile);
		console.log(`side file written to ${destFile}`);
	} catch (err) {
		console.error(err.stack);
		process.exit(1);
	}
})();